
@{
    ViewBag.Title = "Home Page";
}
@model List<Date_ver2.Models.User>
@using Date_ver2.Models



<style>
    .fade {
        transition: opacity 0.2s ease;
    }

    .alert {
        position: absolute;
        top: 10%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 9999;
        display: none;
        padding: 10px;
        border-radius: 5px;
        background-color: #dff0d8;
        color: #3c763d;
        font-weight: bold;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    }
</style>

<main>

    <div class="m-5">
        <!-- Button to trigger the modal -->
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Set Start and End Date</button>
    </div>

    <!-- The Modal -->
    <div class="modal fade" id="myModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Select Dates</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <!-- Modal Body -->
                <div class="modal-body">
                    <div class="modal-body">
                        <form>
                            <div class="form-group row">
                                <label for="dateStart" class="col-sm-3 col-form-label">Start Date</label>
                                <div class="col-sm-9">
                                    <div class="input-group date" id="datetimepickerStart" data-target-input="nearest">
                                        <input type="text" class="form-control datetimepicker-input" data-target="#datetimepickerStart" id="dateStart" required />
                                        <div class="input-group-append" data-target="#datetimepickerStart" data-toggle="datetimepicker">
                                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="dateEnd" class="col-sm-3 col-form-label">End Date</label>
                                <div class="col-sm-9">
                                    <div class="input-group date" id="datetimepickerEnd" data-target-input="nearest">
                                        <input type="text" class="form-control datetimepicker-input" data-target="#datetimepickerEnd" id="dateEnd" required />
                                        <div class="input-group-append" data-target="#datetimepickerEnd" data-toggle="datetimepicker">
                                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- Modal Footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="saveButton">Save</button>
                </div>
            </div>
        </div>
    </div>
    <div id="successPopup" class="alert alert-success" style="display: none;">
        Dates saved successfully!
    </div>


    <table id="myTable" class="table table-condensed table-hover">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Address</th>
                <th>Country</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>Hans Gier</td>
                <td>Tambulilid</td>
                <td>Nigeria</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Hanssss Gier</td>
                <td>Tambulilidssss</td>
                <td>Nigeriassss</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Hansss Gier</td>
                <td>Tambulilidsss</td>
                <td>Nigeriasss</td>
            </tr>
            <tr>
                <td>4</td>
                <td>Hanss Gier</td>
                <td>Tambulilidss</td>
                <td>Nigeriass</td>
            </tr>
        </tbody>
    </table>

    <br/><br />

    <h5>Datatable with User Class/Model</h5>
    <table id="myTable_ver2" class="table table-condensed table-hover">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Address</th>
                <th>Country</th>
            </tr>
        </thead>
        @foreach (var user in Model)
        {
            <tr>
                <td>@user.Id</td>
                <td>@user.Name</td>
                <td>@user.Address</td>
                <td>@user.Country</td>
            </tr>
        }
    </table>
</main>

<!-- Include Bootstrap and jQuery JavaScript libraries -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
    var modelData = @Html.Raw(Json.Encode(Model));
    console.log(modelData);

    $(document).ready(function () {

        //
        // Start For data table
        //

        // Define datatable
        $('myTable').DataTable();

        // Initialize DataTable with sorting options
        $('#myTable').DataTable({
            "columnDefs": [
                { "orderable": false, "targets": 0 }, // First column (index 0) is not sortable
                { "orderable": true, "targets": [1, 2, 3] } // Allow sorting for other columns
            ]
        });


        // Define datatable ver2
        $('myTable_ver2').DataTable();

        // Initialize DataTable with sorting options
        $('#myTable_ver2').DataTable({
            "columnDefs": [
                { "orderable": false, "targets": 0 }, // First column (index 0) is not sortable
                { "orderable": true, "targets": [1, 2, 3] } // Allow sorting for other columns
            ]
        });

        //
        // End for data table
        //




        //
        //Start for Button Pop-up
        //


        // Calculate current date and time using Moment.js
        const now = moment();
        const tomorrow = moment().add(1, 'day');

        // Format the dates for input values
        const formattedNow = now.format('MM/DD/YYYY hh:mm:ss A');
        const formattedTomorrow = tomorrow.format('MM/DD/YYYY hh:mm:ss A');

        // Set default values for the input fields
        $('#datetimepickerStart').datetimepicker({
            format: 'MM/DD/YYYY hh:mm:ss A',
            minDate: now // Set minDate to current date
        });

        $('#datetimepickerEnd').datetimepicker({
            format: 'MM/DD/YYYY hh:mm:ss A',
            minDate: now // Set minDate to current date
        });

        // Set initial input field values
        $('#dateStart').val(formattedNow);
        $('#dateEnd').val(formattedTomorrow);

        // Initialize date picker interaction
        $('#datetimepickerStart').on('change.datetimepicker', function (e) {
            $('#datetimepickerEnd').datetimepicker('minDate', e.date);
        });

        // Save button click event
        $('#saveButton').click(function () {
            const startDate = $('#dateStart').val();
            const endDate = $('#dateEnd').val();

            // Save the dates to local storage
            localStorage.setItem('startDate', startDate);
            localStorage.setItem('endDate', endDate);

            // Show the success popup
            $('#successPopup').fadeIn();

            // Close the success popup after 3 seconds
            setTimeout(function () {
                $('#successPopup').fadeOut(function () {
                    // Clear the success popup display property
                    $(this).css('display', '');
                });
            }, 3000);
        });

        // Modal show event
        $('#myModal').on('show.bs.modal', function () {
            // Clear the success popup display property
            $('#successPopup').css('display', '');
        });

        //
        //End for Button Pop-up
        //
    });
</script>